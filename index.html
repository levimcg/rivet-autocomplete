<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Rivet autocomplete</title>
  <link rel="stylesheet" href="https://assets.uits.iu.edu/css/rivet/1.3.0/rivet.min.css">
  <link rel="stylesheet" href="./css/rivet-autocomplete.css">
</head>
<body class="rvt-p-all-xxl">
  <div class="rvt-container rvt-container--freshman rvt-container--center">
    <span class="rvt-text-uppercase rvt-ts-14 rvt-text-bold rvt-color-orange">prototype</span>
    <h1 class="rvt-ts-lg rvt-text-bold">Rivet Autocomplete</h1>
    <p class="rvt-m-top-xxs rvt-m-bottom-xxl rvt-ts-20">An combobox-style autocomplete widget for Rivet</p>
    
    <h2 class="rvt-ts-sm rvt-text-bold">Basic example</h2>
    <div id="auto-complete-too" class="rvt-m-top-xl">
      <form action="some-server-side-script.php">
        <label for="my-fallback">Search</label>
        <input type="text" id="my-fallback">
        <button class="rvt-button">Search</button>
      </form>
    </div>
    
    <div id="auto-complete-one" class="rvt-m-top-xl">
      
    </div>
    
  </div>
  
  <script src="./rivet-autocomplete.js"></script>
  
  <script>
    // Progressive enhancement
    
    function replaceContents(node) {
      node.innerHTML = '';
      return node;
    }
    
    const targetNode = document.getElementById('auto-complete-too');
    
    // The autocomplete instance
    
    const repoSearch = new RivetAutocomplete({
      target: replaceContents(targetNode),
      data: {
        label: 'Search repos',
        noResultsText: 'No results found',
        threshold: 2,
        /**
        matchStrategy: function(data, value) {
          return data.filter(function(item) {
            return item === value;
          });
        }
        */
      }
    });
    
    fetch('https://api.github.com/orgs/indiana-university/repos')
      .then(res => res.json())
      .then(json => json.map(item => item.name))
      .then(data => {
        repoSearch.set({dataSet: data});
      });

  </script>
  
</body>
</html>